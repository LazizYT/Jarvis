# functions.py
import re
import random
from typing import List, Optional, Dict, Any
import html
import re
import random
from typing import List, Optional, Dict, Any, Tuple
import html
from datetime import datetime
import json


def format_code_with_ui(code: str, language: str = "python", 
                        title: str = "üìù –ö–æ–¥", 
                        comment: str = None) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∫–æ–¥ —Å HTML-—Ä–∞–∑–º–µ—Ç–∫–æ–π, —Ü–≤–µ—Ç–∞–º–∏, –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
    
    Args:
        code: –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
        language: –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è (python/javascript/html –∏ —Ç.–¥.)
        title: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –±–ª–æ–∫–∞ –∫–æ–¥–∞
        comment: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–¥ –∫–æ–¥–æ–º
    
    Returns:
        HTML-—Å—Ç—Ä–æ–∫–∞ —Å –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–º –∫–æ–¥–æ–º
    """
    # –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º HTML-—Å–∏–º–≤–æ–ª—ã –≤ –∫–æ–¥–µ
    escaped_code = html.escape(code)
    
    # –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —è–∑—ã–∫–∞
    language_colors = {
        "python": "#3572A5",
        "javascript": "#F1E05A",
        "html": "#E34C26",
        "css": "#563D7C",
        "bash": "#89E051",
        "sql": "#E38C00"
    }
    
    color = language_colors.get(language, "#6E7681")
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML
    html_output = f'''
    <div class="code-container" style="
        background: #1E1E1E;
        border-radius: 12px;
        padding: 20px;
        margin: 20px 0;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        border-left: 5px solid {color};
        position: relative;
        font-family: 'Fira Code', 'Consolas', monospace;
    ">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #444;
        ">
            <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 24px;">üíª</span>
                <h3 style="
                    color: {color};
                    margin: 0;
                    font-size: 18px;
                    font-weight: 600;
                ">{title}</h3>
                <span style="
                    background: {color};
                    color: white;
                    padding: 2px 10px;
                    border-radius: 20px;
                    font-size: 12px;
                    font-weight: 500;
                ">{language.upper()}</span>
            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <button onclick="copyCode(this)" style="
                background: {color};
                color: white;
                border: none;
                padding: 8px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-family: inherit;
                font-weight: 500;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 8px;
            " onmouseover="this.style.opacity='0.9'" 
            onmouseout="this.style.opacity='1'">
                üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
            </button>
        </div>
        
        <!-- –ë–ª–æ–∫ —Å –∫–æ–¥–æ–º -->
        <pre style="
            color: #E6E6E6;
            margin: 0;
            padding: 20px;
            overflow-x: auto;
            background: #252526;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        "><code style="font-family: inherit;">{escaped_code}</code></pre>
        
        <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π -->
        {f'''
        <div style="
            margin-top: 15px;
            padding: 12px;
            background: rgba({int(color[1:3], 16)}, {int(color[3:5], 16)}, {int(color[5:7], 16)}, 0.1);
            border-radius: 6px;
            border-left: 3px solid {color};
            color: #B0B0B0;
            font-size: 14px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        ">
            <span style="font-size: 16px;">üí°</span>
            <div>{comment}</div>
        </div>
        ''' if comment else ''}
    </div>
    
    <!-- JavaScript –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <script>
    function copyCode(button) {{
        const codeContainer = button.closest('.code-container');
        const codeElement = codeContainer.querySelector('code');
        const textArea = document.createElement('textarea');
        textArea.value = codeElement.textContent;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        
        // –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ñ–∏–¥–±—ç–∫
        const originalText = button.innerHTML;
        button.innerHTML = '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
        button.style.background = '#10B981';
        
        setTimeout(() => {{
            button.innerHTML = originalText;
            button.style.background = '{color}';
        }}, 2000);
    }}
    </script>
    '''
    
    return html_output


def generate_creative_ideas(context: List[Dict[str, Any]]) -> List[str]:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –∏–¥–µ–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞
    
    Args:
        context: –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
        
    Returns:
        –°–ø–∏—Å–æ–∫ –∏–¥–µ–π —Å —ç–º–æ–¥–∑–∏
    """
    ideas = []
    
    # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    recent_messages = " ".join([msg.get("content", "")[-500:] 
                               for msg in context[-3:] if msg.get("role") == "user"])
    
    # –û–±—â–∏–µ –∏–¥–µ–∏ –¥–ª—è –ª—é–±–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    general_ideas = [
        "üé® –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ UX",
        "üöÄ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ",
        "üîß –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–ª–∞–≥–∏–Ω–æ–≤ –¥–ª—è —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏",
        "üìä –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π",
        "ü§ñ –í–Ω–µ–¥—Ä–∏—Ç—å –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
        "üéØ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞",
        "‚ú® –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–º–Ω—É—é/—Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è",
        "üîî –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è",
        "üì± –°–¥–µ–ª–∞—Ç—å Progressive Web App –≤–µ—Ä—Å–∏—é",
        "üåê –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤"
    ]
    
    # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º—ã–µ –∏–¥–µ–∏
    if any(word in recent_messages.lower() for word in ['–±–∞–∑–∞', '–¥–∞–Ω–Ω', 'sql', '—Ö—Ä–∞–Ω–∏–ª–∏—â']):
        ideas.extend([
            "üóÑÔ∏è –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π",
            "üìà –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏",
            "üîç –í–Ω–µ–¥—Ä–∏—Ç—å –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –¥–∞–Ω–Ω—ã–º",
            "üîÑ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ"
        ])
    
    if any(word in recent_messages.lower() for word in ['ui', '–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å', '–¥–∏–∑–∞–π–Ω', '–≤–µ—Ä—Å—Ç–∫']):
        ideas.extend([
            "üé≠ –°–æ–∑–¥–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å Storybook",
            "üåà –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –∏ –ø–∞—Ä–∞–ª–ª–∞–∫—Å-—ç—Ñ—Ñ–µ–∫—Ç—ã",
            "üì± –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é —Å–µ—Ç–∫—É –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤",
            "üéÆ –î–æ–±–∞–≤–∏—Ç—å –º–∏–∫—Ä–æ-–∏–Ω—Ç–µ—Ä–∞–∫—Ü–∏–∏ –¥–ª—è –∫–ª–∏–∫–æ–≤"
        ])
    
    if any(word in recent_messages.lower() for word in ['api', '—Å–µ—Ä–≤–µ—Ä', 'backend', '–∑–∞–ø—Ä–æ—Å']):
        ideas.extend([
            "üõ°Ô∏è –î–æ–±–∞–≤–∏—Ç—å rate limiting –∏ DDoS –∑–∞—â–∏—Ç—É",
            "üìù –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API —á–µ—Ä–µ–∑ Swagger",
            "‚ö° –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å GraphQL –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É REST",
            "üîê –î–æ–±–∞–≤–∏—Ç—å OAuth2 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é"
        ])
    
    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—â–∏–µ –∏–¥–µ–∏, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –º–∞–ª–æ
    if len(ideas) < 4:
        ideas.extend(random.sample(general_ideas, 4 - len(ideas)))
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —ç–º–æ–¥–∑–∏ –∫ –∏–¥–µ—è–º
    enhanced_ideas = []
    for idea in ideas:
        # –£–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤–æ–µ —ç–º–æ–¥–∑–∏, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å, –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ
        emojis = ["üöÄ", "üí°", "üåü", "üéØ", "‚ú®", "üî•", "‚ö°", "üíé", "üé®", "ü§ñ"]
        if idea[0] in ["\U0001F300", "\U0001F600"]:  # –ï—Å–ª–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —ç–º–æ–¥–∑–∏
            idea = idea[2:]  # –£–±–∏—Ä–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —ç–º–æ–¥–∑–∏ –∏ –ø—Ä–æ–±–µ–ª
        enhanced_ideas.append(f"{random.choice(emojis)} {idea}")
    
    return enhanced_ideas


def add_emojis_to_text(text: str, intensity: float = 0.3) -> str:
    """
    –î–æ–±–∞–≤–ª—è–µ—Ç —ç–º–æ–¥–∑–∏ –≤ —Ç–µ–∫—Å—Ç –¥–ª—è –±–æ–ª—å—à–µ–π –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
    
    Args:
        text: –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
        intensity: –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç–º–æ–¥–∑–∏ (0-1)
        
    Returns:
        –¢–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏
    """
    if not text or intensity <= 0:
        return text
    
    # –°–ª–æ–≤–∞—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π —Å–ª–æ–≤ –∏ —ç–º–æ–¥–∑–∏
    emoji_map = {
        r'\b–æ—Ç–ª–∏—á–Ω\w*\b': 'üåü',
        r'\b—Ö–æ—Ä–æ—à\w*\b': 'üëç',
        r'\b–ø–ª–æ—Ö\w*\b': 'üëé',
        r'\b–≤–∞–∂–Ω\w*\b': '‚ö†Ô∏è',
        r'\b–≤–Ω–∏–º–∞–Ω–∏\w*\b': 'üëÄ',
        r'\b–∏–Ω—Ç–µ—Ä–µ—Å–Ω\w*\b': 'üîç',
        r'\b–±—ã—Å—Ç—Ä\w*\b': '‚ö°',
        r'\b–º–µ–¥–ª–µ–Ω–Ω\w*\b': 'üê¢',
        r'\b–ª–µ–≥–∫\w*\b': 'ü™∂',
        r'\b—Å–ª–æ–∂–Ω\w*\b': 'üèãÔ∏è',
        r'\b–Ω–æ–≤\w*\b': 'üÜï',
        r'\b—Å—Ç–∞—Ä\w*\b': 'üï∞Ô∏è',
        r'\b–∫—Ä–∞—Å–∏–≤\w*\b': 'üíñ',
        r'\b—É–∂–∞—Å–Ω\w*\b': 'üò±',
        r'\b—Å–º–µ—à–Ω\w*\b': 'üòÑ',
        r'\b–≥—Ä—É—Å—Ç–Ω\w*\b': 'üò¢',
        r'\b—É—Å–ø–µ—Ö\w*\b': 'üèÜ',
        r'\b–æ—à–∏–±–∫\w*\b': '‚ùå',
        r'\b–≤–æ–ø—Ä\w*\b': '‚ùì',
        r'\b–æ—Ç–≤–µ—Ç\w*\b': 'üí¨',
        r'\b—Å–æ–≤–µ—Ç\w*\b': 'üí°',
        r'\b–∏–¥–µ\w*\b': 'üí≠',
        r'\b–ø—Ä–∏–≤–µ—Ç\w*\b': 'üëã',
        r'\b–ø–æ–∫–∞\b': 'üëã',
        r'\b—Å–ø–∞—Å–∏–±\w*\b': 'üôè',
        r'\b–ø–æ–∂–∞–ª—É–π—Å—Ç–∞\b': 'üòä',
        r'\b–∏–∑–≤–∏–Ω–∏\w*\b': 'üòî',
        r'\b—Ä–∞–¥\w*\b': 'üòÑ',
        r'\b–∫–æ–Ω–µ—Ü\b': 'üèÅ',
        r'\b–Ω–∞—á–∞–ª\w*\b': 'üöÄ',
        r'\b—Å–¥–µ–ª\w*\b': '‚úÖ',
        r'\b—Ä–∞–±–æ—Ç–∞\w*\b': 'üë∑',
        r'\b—É—á\w*\b': 'üìö',
        r'\b–∫–æ–¥\w*\b': 'üíª',
        r'\b–ø—Ä–æ–≥—Ä–∞–º\w*\b': 'üë®‚Äçüíª',
        r'\b–ø—Ä–æ–µ–∫—Ç\w*\b': 'üìÅ',
        r'\b—Ñ–∞–π–ª\w*\b': 'üìÑ',
        r'\b–ø–∞–ø–∫\w*\b': 'üìÅ',
        r'\b–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å\w*\b': 'üé®',
        r'\b–¥–∏–∑–∞–π–Ω\w*\b': '‚ú®',
        r'\b—Ü–≤–µ—Ç\w*\b': 'üé®',
        r'\b—à—Ä–∏—Ñ—Ç\w*\b': 'üî§',
        r'\b—Ä–∞–∑–º–µ—Ä\w*\b': 'üìè',
        r'\b–ø–æ–∑–∏—Ü–∏\w*\b': 'üìç',
    }
    
    # –≠–º–æ–¥–∑–∏ –¥–ª—è –∫–æ–Ω—Ü–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
    sentence_end_emojis = ['‚ú®', 'üåü', 'üí´', 'üéØ', 'üî•', '‚ö°', 'üíé', 'üéâ']
    
    sentences = text.split('. ')
    result_sentences = []
    
    for sentence in sentences:
        if not sentence.strip():
            continue
            
        # –î–æ–±–∞–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏ –∫ —Å–ª–æ–≤–∞–º
        words = sentence.split()
        new_words = []
        
        for word in words:
            original_word = word
            # –£–±–∏—Ä–∞–µ–º –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            clean_word = re.sub(r'[^\w]', '', word.lower())
            
            added_emoji = False
            for pattern, emoji in emoji_map.items():
                if re.search(pattern, clean_word, re.IGNORECASE) and random.random() < intensity:
                    # –î–æ–±–∞–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏ –ø–æ—Å–ª–µ —Å–ª–æ–≤–∞
                    if word[-1].isalnum():
                        new_words.append(f"{word} {emoji}")
                    else:
                        new_words.append(f"{word[:-1]} {emoji}{word[-1]}")
                    added_emoji = True
                    break
            
            if not added_emoji:
                new_words.append(word)
        
        new_sentence = ' '.join(new_words)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏ –≤ –∫–æ–Ω–µ—Ü –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (—Å —à–∞–Ω—Å–æ–º)
        if random.random() < intensity * 0.5 and new_sentence.strip() and not new_sentence.endswith('?'):
            new_sentence += f' {random.choice(sentence_end_emojis)}'
        
        result_sentences.append(new_sentence)
    
    result = '. '.join(result_sentences)
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —ç–º–æ–¥–∑–∏ –≤ –Ω–∞—á–∞–ª–µ –∏–ª–∏ –∫–æ–Ω—Ü–µ —Ç–µ–∫—Å—Ç–∞
    if random.random() < intensity:
        starters = ['üöÄ ', 'üí° ', '‚ú® ', 'üåü ']
        if random.random() < 0.3:
            result = random.choice(starters) + result
    
    return result


def suggest_features_based_on_context(history: List[Dict], current_topic: str) -> Dict[str, Any]:
    """
    –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ñ–∏—á–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
    
    Args:
        history: –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
        current_topic: –¢–µ–∫—É—â–∞—è —Ç–µ–º–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
        
    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏
    """
    suggestions = {
        "features": [],
        "improvements": [],
        "warnings": [],
        "tools": []
    }
    
    # –ê–Ω–∞–ª–∏–∑ —Ç–µ–º—ã
    topic_lower = current_topic.lower()
    
    if any(word in topic_lower for word in ['–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü', 'login', 'auth', '–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç']):
        suggestions["features"].extend([
            "üîê –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA)",
            "üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫",
            "üìß –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏",
            "üë• –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π"
        ])
        suggestions["warnings"].append("‚ö†Ô∏è –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ!")
    
    if any(word in topic_lower for word in ['—Ñ–æ—Ä–º–∞', '–≤–≤–æ–¥', '–≤–∞–ª–∏–¥–∞—Ü', '–ø–æ–ª—å–∑–æ–≤']):
        suggestions["features"].extend([
            "‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏",
            "üîÑ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã",
            "üì± –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –≤–≤–æ–¥–∞",
            "üéØ –£–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏"
        ])
        suggestions["improvements"].append("‚ú® –î–æ–±–∞–≤—å—Ç–µ –º–∏–∫—Ä–æ–∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞")
    
    if any(word in topic_lower for word in ['–∞–ø–∏', '–∑–∞–ø—Ä–æ—Å', '—Å–µ—Ä–≤–µ—Ä', '–∫–ª–∏–µ–Ω—Ç']):
        suggestions["features"].extend([
            "‚ö° –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤",
            "üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö",
            "üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤",
            "üîó –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö"
        ])
        suggestions["tools"].append("üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Postman –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API")
    
    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—â–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
    suggestions["features"].extend([
        "üìà –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è",
        "üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã –ø–æ–¥ –±—Ä–µ–Ω–¥",
        "üîî Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ",
        "üíæ –û—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã"
    ])
    
    return suggestions


def create_welcome_message() -> str:
    """–°–æ–∑–¥–∞–µ—Ç –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"""
    welcome_templates = [
        """üéâ *–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Ç–≤–æ—Ä—á–µ—Å–∫—É—é –º–∞—Å—Ç–µ—Ä—Å–∫—É—é –∫–æ–¥–∞!* üéâ

‚ú® **–ì–æ—Ç–æ–≤—ã —Ç–≤–æ—Ä–∏—Ç—å?** –Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã:
‚Ä¢ üöÄ –ü–æ–º–æ—á—å —Å –∫–æ–¥–æ–º –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
‚Ä¢ üí° –ü–æ–¥—Å–∫–∞–∑–∞—Ç—å –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
‚Ä¢ üé® –£–∫—Ä–∞—Å–∏—Ç—å –≤–∞—à –ø—Ä–æ–µ–∫—Ç
‚Ä¢ üîß –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

üìö **–ß—Ç–æ —É–º–µ—é:**
‚Üí –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ —Å –∫—Ä–∞—Å–∏–≤—ã–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º
‚Üí –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –∏–¥–µ–∏ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
‚Üí –î–æ–±–∞–≤–ª—è—Ç—å —ç–º–æ–¥–∑–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
‚Üí –î–µ–ª–∏—Ç—å—Å—è –ª—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏

üí¨ **–ü—Ä–æ—Å—Ç–æ –Ω–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å ‚Äî –∏ –º–∞–≥–∏—è –Ω–∞—á–Ω–µ—Ç—Å—è!** ‚ú®""",
        
        """üëã *–ü—Ä–∏–≤–µ—Ç, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫!* üíª

üåü **–†–∞–¥ –≤–∏–¥–µ—Ç—å –≤–∞—Å –∑–¥–µ—Å—å!** –Ø ‚Äî –≤–∞—à AI-–∫–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è:
‚Ä¢ üéØ –†–µ—à–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á
‚Ä¢ üîç –ê–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞
‚Ä¢ üíé –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–π
‚Ä¢ üöÄ –£—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

üõ†Ô∏è **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞—à–µ–≥–æ —á–∞—Ç–∞:**
‚ñ∏ –ö–æ–¥ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π –∏ –∫–Ω–æ–ø–∫–æ–π –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
‚ñ∏ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
‚ñ∏ –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏
‚ñ∏ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

üí° **–°–æ–≤–µ—Ç –¥–Ω—è:** *–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –∫–æ–¥–∞ ‚Äî —ç—Ç–æ –∫–∏—Å—Ç—å –≤ —Ä—É–∫–∞—Ö —Ö—É–¥–æ–∂–Ω–∏–∫–∞* üé®

**–í–ø–µ—Ä–µ–¥, –∫ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤—É!** ‚ö°""",
        
        """üöÄ *–ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!* üí´

üíé **–ú–∏—Å—Å–∏—è:** –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤–∞—à–∏ –∏–¥–µ–∏ –≤ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π –∫–æ–¥

üõ†Ô∏è **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ –≤–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏:**
‚Ä¢ üìù –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–¥–∞
‚Ä¢ üé® –°—Ç–∏–ª–∏–∑–∞—Ç–æ—Ä –∏ —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä
‚Ä¢ üí° –ò–¥–µ–π–Ω—ã–π –∏–Ω–∫—É–±–∞—Ç–æ—Ä
‚Ä¢ üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç–Ω–∏–∫

üåà **–ß—Ç–æ –Ω–æ–≤–æ–≥–æ:**
‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏
‚Üí –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏
‚Üí UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∫–æ–¥–∞
‚Üí –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏

üéØ **–ü–æ–º–Ω–∏—Ç–µ:** *–õ—É—á—à–∏–π –∫–æ–¥ ‚Äî —ç—Ç–æ —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–æ—Å–∏—Ç —Ä–∞–¥–æ—Å—Ç—å* üòä

**–ù–∞—á–Ω–µ–º –Ω–∞—à–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ!** üåü"""
    ]
    
    return random.choice(welcome_templates)